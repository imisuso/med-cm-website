import{o as i,c as h,a as x,G as E,l as M,r as l,K as T,J as L,w as N,b as d,e as k,a8 as q,u as c,d as o,F as S,f as $,t as z,i as P,g,v as A,q as G,n as H,C as J,a7 as K,O as m,S as R,U as W}from"./app.8c4d088b.js";import{_ as Q}from"./PersonInteractiveCardList.a4289b25.js";import{_ as X}from"./Paginations.b93e1798.js";import{D as Y}from"./DivisionService.aa83cfa6.js";import{t as Z}from"./style.16fc01d4.js";import{S as ee}from"./sweetalert2.all.eca76e21.js";import"./ToggleSwitch.1a6a8fd5.js";import"./EyeIcon.1333dde9.js";function te(n,f){return i(),h("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"2",stroke:"currentColor","aria-hidden":"true"},[x("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})])}const w=n=>(R("data-v-15fbeec4"),n=n(),W(),n),se={class:"flex flex-col px-2 py-1 w-full"},oe=w(()=>o("div",{class:"mt-2 mb-2 text-2xl font-bold"},"\u0E08\u0E31\u0E14\u0E01\u0E32\u0E23\u0E1A\u0E38\u0E04\u0E25\u0E32\u0E01\u0E23",-1)),ne={key:0,class:"flex flex-col sm:flex-row items-start sm:items-center mb-2"},ie=w(()=>o("div",{class:"sm:w-32 text-sm font-medium text-gray-700"},"\u0E2A\u0E32\u0E02\u0E32/\u0E2B\u0E19\u0E48\u0E27\u0E22\u0E07\u0E32\u0E19:",-1)),re=["value"],le={class:"flex flex-col sm:flex-row sm:justify-between px-2 py-2 space-y-2 mb-2 w-full border rounded-md shadow-md items-baseline"},ae={class:"flex space-x-2 w-full place-self-center"},de={key:0,class:"flex space-x-2"},ce={class:"flex items-center w-28 py-1 px-3 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-black hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500"},ue=w(()=>o("div",null,"\u0E40\u0E23\u0E35\u0E22\u0E07\u0E25\u0E33\u0E14\u0E31\u0E1A",-1)),me={class:"flex flex-col w-full mb-4"},fe={class:"flex justify-center md:justify-end mt-2 px-4"},pe={layout:K},_e=Object.assign(pe,{__name:"Index",props:{persons:{type:Object,required:!0,default:{}},filters:{type:Object}},setup(n){const f=n;M(()=>{C.value.listAll().then(e=>{p.value=e})});const B="/fallbackimage/default-blank-image.jpg",C=l(new Y),p=l([]),_=l(null),I=l(base_url);let r=f.filters.fdivision_selected?l(f.filters.fdivision_selected):l(T().props.auth.division_id),u=l(f.filters.search);const a=L({id:null,fullname:null});N(u,e=>{m.get(route("admin.person"),{search:e,fdivision_selected:r.value},{preserveState:!0,replace:!0})});const b=(e,s,t)=>{Z({title:s,description:t},{showIcon:!0,transition:"zoom",position:"top-right",type:e,timeout:3e3})},j=()=>{m.delete(route("admin.person.delete",a.id),{preserveState:!0,onSuccess:()=>{b("success","\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08","\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E1A\u0E38\u0E04\u0E25\u0E32\u0E01\u0E23 \u0E40\u0E23\u0E35\u0E22\u0E1A\u0E23\u0E49\u0E2D\u0E22")},onError:e=>{let s="";for(let t in e)s=s+`- ${e[t]}<br/>`;b("danger","\u0E1E\u0E1A\u0E1B\u0E31\u0E0D\u0E2B\u0E32",s)},onFinish:()=>{a.processing=!1}})},V=()=>{m.get(route("admin.person"),{fdivision_selected:r.value},{preserveState:!0,replace:!0})},D=e=>{m.get(route("admin.person.view",e.id),{},{preserveState:!0,replace:!0})},F=e=>{m.get(route("admin.person.edit",e.id),{},{preserveState:!0,replace:!0})},O=e=>{_.value=e.image?e.image_url:`${I.value}${B}`,a.id=e.id,a.fullname=`${e.fname_th} ${e.lname_th}`,ee.fire({title:"\u0E04\u0E38\u0E13\u0E41\u0E19\u0E48\u0E43\u0E08\u0E27\u0E48\u0E32\u0E15\u0E49\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E25\u0E1A\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E1A\u0E38\u0E04\u0E25\u0E32\u0E01\u0E23?",text:`${a.fullname}`,imageUrl:_.value,imageWidth:80,imageHeight:80,showCancelButton:!0,confirmButtonColor:"#b91c1c",cancelButtonColor:"#6b7280",confirmButtonText:"\u0E25\u0E1A",cancelButtonText:"\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01"}).then(s=>{s.isConfirmed?j():(a.reset(),_.value=null)})},U=e=>{let s=p.value.filter(t=>t.division_id===e);return s.length>0?s[0].slug:""};return(e,s)=>(i(),d("div",se,[oe,e.$page.props.auth.abilities.includes("view_all_content")?(i(),d("div",ne,[ie,k(o("select",{"onUpdate:modelValue":s[0]||(s[0]=t=>P(r)?r.value=t:r=t),onChange:V,id:"form_division_id",class:"mt-1 w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},[(i(!0),d(S,null,$(p.value,(t,v)=>(i(),d("option",{key:v,value:t.division_id},z(t.name_th),9,re))),128))],544),[[q,c(r)]])])):g("",!0),o("div",le,[o("div",ae,[k(o("input",{"onUpdate:modelValue":s[1]||(s[1]=t=>P(u)?u.value=t:u=t),type:"text",id:"search",placeholder:"\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E14\u0E49\u0E27\u0E22 \u0E0A\u0E37\u0E48\u0E2D \u0E2B\u0E23\u0E37\u0E2D \u0E19\u0E32\u0E21\u0E2A\u0E01\u0E38\u0E25",class:"block mx-1 focus:ring-indigo-500 focus:border-indigo-500 w-full shadow-sm sm:text-sm border-gray-300 rounded-md"},null,512),[[A,c(u)]])]),e.$page.props.auth.abilities.includes("manage_person")?(i(),d("div",de,[c(r)!=0&&n.persons.total>1?(i(),h(c(J),{key:0,href:e.route("admin.person_order",U(parseInt(c(r))))},{default:G(()=>[o("button",ce,[o("div",null,[x(c(te),{class:H(["h-6 w-6"])})]),ue])]),_:1},8,["href"])):g("",!0)])):g("",!0)]),o("div",me,[(i(!0),d(S,null,$(n.persons.data,(t,v)=>(i(),h(Q,{key:v,personDetails:t,"order-input":!1,onEditPerson:y=>F(t),onViewPerson:y=>D(t),onDeletePerson:y=>O(t)},null,8,["personDetails","onEditPerson","onViewPerson","onDeletePerson"]))),128))]),o("div",fe,[x(X,{pagination:n.persons},null,8,["pagination"])])]))}});var Se=E(_e,[["__scopeId","data-v-15fbeec4"]]);export{Se as default};
